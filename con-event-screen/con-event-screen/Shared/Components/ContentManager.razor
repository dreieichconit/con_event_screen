@using con_event_services.Interfaces
@inherits LayoutComponentBase
@inject IStateController Controller

<div class="contentManager">
    <ImageViewer Src="@LogoSrc" Visible="@IsPlanVisible"></ImageViewer>
    <GamesViewer Visible="@IsGamesVisible" Order="1" Page="@Page"></GamesViewer>
    <ProgramViewer Visible="@IsProgramVisible" Order="2"></ProgramViewer>
</div>


@code {

    private int VisibleState = 0;

    private int Page => VisibleState - 1;

    private bool IsPlanVisible => VisibleState is 0; 

    private bool IsGamesVisible => VisibleState is 1 or 2 or 3;

    private bool IsProgramVisible => VisibleState is 4;

    protected override async Task OnInitializedAsync()
    {
        VisibleState = Controller.ContentState;
        Controller.HalfMinuteElapsed += TriggerSwitch;
    }

    private void TriggerSwitch(object? e, EventArgs ee)
    {
        if (VisibleState < 4)
        {
            Controller.TriggerContentChanged(VisibleState + 1);
        }
        else
        {
            Controller.TriggerContentChanged(0);
        }
        
        VisibleState = Controller.ContentState;
        InvokeAsync(StateHasChanged);
    }
    
    private string PlanSrc { get; set; } = @".\img\plan.png";
    
    private string LogoSrc { get; set; } = @".\img\ratcon.jpg";
}